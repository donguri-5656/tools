<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ„ãƒ¼ãƒ«</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background-color: #f4f4f9;
        }
        .container {
            max-width: 900px;
            margin: 0 auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        h1 {
            color: #333;
            text-align: center;
            margin-bottom: 5px; /* èª¬æ˜æ–‡ã¨ã®é–“éš”ã‚’èª¿æ•´ */
        }
        .info-box {
            background-color: #e6f7ff;
            border: 1px solid #91d5ff;
            padding: 15px;
            margin-bottom: 20px;
            border-radius: 4px;
            color: #1a629b;
        }
        .info-box p {
            margin: 0 0 8px 0;
            line-height: 1.6;
        }
        textarea {
            width: 100%;
            min-height: 200px;
            padding: 10px;
            margin-bottom: 10px;
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }
        
        /* --- é™¤å¤–æ–‡å­—ã‚³ãƒ³ãƒˆãƒ­ãƒ¼ãƒ«ã‚¨ãƒªã‚¢ --- */
        .controls {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            padding: 10px;
            background-color: #e9e9e9;
            border-radius: 4px;
        }
        .controls label {
            margin-right: 10px;
            font-weight: bold;
            white-space: nowrap;
        }
        .controls input[type="text"] {
            padding: 5px;
            border: 1px solid #ccc;
            border-radius: 4px;
            flex-grow: 1; 
            min-width: 150px;
        }

        /* --- ã‚«ã‚¦ãƒ³ãƒˆçµæœã‚¨ãƒªã‚¢ã®2åˆ—ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ --- */
        .results {
            border-top: 2px solid #ddd;
            padding-top: 15px;
        }
        .results-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        .column {
            display: flex;
            flex-direction: column;
        }
        
        /* --- å€‹åˆ¥ã®çµæœé …ç›® --- */
        .result-item {
            margin-bottom: 8px;
            padding: 5px;
            background-color: #f9f9f9;
            border-left: 5px solid #007bff;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .result-item strong {
            display: inline-block;
            flex-shrink: 0;
            width: 70%;
            color: #007bff;
            padding-right: 10px;
            overflow: hidden; 
        }
        .result-value {
            font-weight: bold;
            color: #333;
            flex-shrink: 0;
            text-align: right;
        }
    </style>
</head>
<body>

<div class="container">
    <h1>æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ„ãƒ¼ãƒ« ğŸ§®</h1>

    <div class="info-box">
        <p>
            å®‰å…¨æ€§ã¨æ©Ÿèƒ½
        </p>
        <p>
            ã“ã®ãƒ„ãƒ¼ãƒ«ã¯ã€ã™ã¹ã¦ã®è¨ˆç®—å‡¦ç†ã‚’ãƒ–ãƒ©ã‚¦ã‚¶å†…ã®JavaScriptã®ã¿ã§å®Œçµã•ã›ã‚‹ãŸã‚ã€å…¥åŠ›ã—ãŸæ–‡å­—æƒ…å ±ã¯ã€å¤–éƒ¨ã‚µãƒ¼ãƒãƒ¼ã«ä¸€åˆ‡é€ä¿¡ã•ã‚Œã¾ã›ã‚“ã€‚
        </p>
        <p>
            ã¾ãŸã€å…¥åŠ›å†…å®¹ã¯Cookieãªã©ã®ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸ã«ã‚‚ä¿å­˜ã•ã‚Œãªã„ãŸã‚ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‚’å†èª­ã¿è¾¼ã¿ã—ãŸã‚Šã€é–‰ã˜ãŸã‚Šã™ã‚‹ã¨ã€å…¥åŠ›ã—ãŸæ–‡å­—ã¯æ¶ˆãˆã¦ã—ã¾ã„ã¾ã™ã€‚
        </p>
    </div>

    <div class="controls">
        <label for="exclude-chars">é™¤å¤–ã™ã‚‹æ–‡å­—ï¼š</label>
        <input type="text" id="exclude-chars" value="">
        <small style="margin-left: 10px;">ï¼ˆä¾‹: ã€Œã€ã€‚ã€ãªã©ã€‚é€£ç¶šã—ã¦å…¥åŠ›ï¼‰</small>
    </div>

    <textarea id="text-input" placeholder="ã“ã“ã«ãƒ†ã‚­ã‚¹ãƒˆã‚’å…¥åŠ›ã—ã¦ãã ã•ã„..."></textarea>

    <div class="results">
        <h2>ã‚«ã‚¦ãƒ³ãƒˆçµæœ</h2>
        
        <div class="results-grid">
            <div class="column">
                <h3>åŸºæœ¬ã¨é™¤å¤–ã«é–¢ã™ã‚‹ã‚«ã‚¦ãƒ³ãƒˆ</h3>
                <div class="result-item"><strong id="total-count-label">å…¨æ–‡å­—æ•°</strong>: <span id="total-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="no-space-count-label">ç©ºç™½ã‚’é™¤ã„ãŸæ–‡å­—æ•°</strong>: <span id="no-space-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="no-newline-count-label">æ”¹è¡Œã‚’é™¤ã„ãŸæ–‡å­—æ•°</strong>: <span id="no-newline-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="no-whitespace-count-label">ç©ºç™½ãƒ»æ”¹è¡Œã‚’é™¤ã„ãŸæ–‡å­—æ•°</strong>: <span id="no-whitespace-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="excluded-count-label">æŒ‡å®šæ–‡å­—ã‚’é™¤ã„ãŸæ–‡å­—æ•°</strong>: <span id="excluded-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="excluded-char-count-label">é™¤å¤–æ–‡å­—ã®åˆè¨ˆæ–‡å­—æ•°</strong>: <span id="excluded-char-count" class="result-value">0</span></div>
            </div>

            <div class="column">
                <h3>è©³ç´°ã¨æ–‡å­—ç¨®åˆ¥ã‚«ã‚¦ãƒ³ãƒˆ</h3>
                <div class="result-item"><strong id="line-count-label">è¡Œæ•°</strong>: <span id="line-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="byte-count-label">æ¨å®šãƒã‚¤ãƒˆæ•° (UTF-8)</strong>: <span id="byte-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="uppercase-count-label">å¤§æ–‡å­— (A-Z) æ•°</strong>: <span id="uppercase-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="lowercase-count-label">å°æ–‡å­— (a-z) æ•°</strong>: <span id="lowercase-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="number-count-label">æ•°å­— (0-9) æ•°</strong>: <span id="number-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="hiragana-count-label">ã²ã‚‰ãŒãªæ•°</strong>: <span id="hiragana-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="katakana-count-label">ã‚«ã‚¿ã‚«ãƒŠæ•°</strong>: <span id="katakana-count" class="result-value">0</span></div>
                <div class="result-item"><strong id="kanji-count-label">æ¼¢å­—æ•°</strong>: <span id="kanji-count" class="result-value">0</span></div>
            </div>
        </div>
    </div>
</div>

<script>
    const textInput = document.getElementById('text-input');
    const excludeCharsInput = document.getElementById('exclude-chars');

    // çµæœè¡¨ç¤ºè¦ç´ ã®å®šç¾©
    const resultsMap = {
        totalCount: document.getElementById('total-count'),
        noSpaceCount: document.getElementById('no-space-count'),
        noNewlineCount: document.getElementById('no-newline-count'),
        noWhitespaceCount: document.getElementById('no-whitespace-count'),
        excludedCount: document.getElementById('excluded-count'),
        excludedCharCount: document.getElementById('excluded-char-count'),
        lineCount: document.getElementById('line-count'),
        byteCount: document.getElementById('byte-count'),
        hiraganaCount: document.getElementById('hiragana-count'),
        katakanaCount: document.getElementById('katakana-count'),
        kanjiCount: document.getElementById('kanji-count'),
        uppercaseCount: document.getElementById('uppercase-count'),
        lowercaseCount: document.getElementById('lowercase-count'),
        numberCount: document.getElementById('number-count'),
        excludedLabel: document.getElementById('excluded-count-label'),
        excludedCharLabel: document.getElementById('excluded-char-count-label'),
    };

    /**
     * æ–‡å­—åˆ—ã®æ¨å®šãƒã‚¤ãƒˆæ•°ã‚’è¨ˆç®—ã—ã¾ã™ï¼ˆUTF-8ã‚¨ãƒ³ã‚³ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ã«åŸºã¥ãï¼‰
     * @param {string} str - å…¥åŠ›æ–‡å­—åˆ—
     * @returns {number} æ¨å®šãƒã‚¤ãƒˆæ•°
     */
    function getByteLength(str) {
        if (typeof TextEncoder !== 'undefined') {
            return new TextEncoder().encode(str).length;
        }
        let len = 0;
        for (let i = 0; i < str.length; i++) {
            const charCode = str.charCodeAt(i);
            if (charCode <= 0x7f) {
                len += 1;
            } else if (charCode <= 0x7ff) {
                len += 2;
            } else if (charCode <= 0xffff) {
                len += 3;
            } else {
                len += 4;
            }
        }
        return len;
    }

    /**
     * ãƒ†ã‚­ã‚¹ãƒˆã‚¨ãƒªã‚¢ã®å†…å®¹ã«åŸºã¥ã„ã¦å„ç¨®æ–‡å­—æ•°ã‚’è¨ˆç®—ã—ã€è¡¨ç¤ºã‚’æ›´æ–°ã—ã¾ã™ã€‚
     */
    function updateCounts() {
        const inputText = textInput.value;
        const excludedChars = excludeCharsInput.value.trim();

        // 1. --- åŸºæœ¬æ–‡å­—æ•°ã‚«ã‚¦ãƒ³ãƒˆ ---
        const countTotal = inputText.length;
        const textNoSpace = inputText.replace(/[ ã€€]/g, '');
        const countNoSpace = textNoSpace.length;
        const textNoNewline = inputText.replace(/\r?\n|\r/g, '');
        const countNoNewline = textNoNewline.length;
        const textNoWhitespace = inputText.replace(/\s/g, '');
        const countNoWhitespace = textNoWhitespace.length;

        // 2. --- æŒ‡å®šæ–‡å­—ã«é–¢ã™ã‚‹ã‚«ã‚¦ãƒ³ãƒˆ ---
        let countExcluded = countTotal;
        let countExcludedCharsInText = 0;
        
        if (excludedChars.length > 0) {
            const escapedChars = excludedChars.replace(/[.*+?^${}()|[\]\\]/g, '\\$&');
            const regex = new RegExp('[' + escapedChars + ']', 'g');
            
            const matches = inputText.match(regex);
            countExcludedCharsInText = matches ? matches.length : 0;

            const textExcluded = inputText.replace(regex, '');
            countExcluded = textExcluded.length;
            
            // ãƒ©ãƒ™ãƒ«ã‚’æ›´æ–°
            resultsMap.excludedLabel.textContent = `ã€Œ${excludedChars}ã€ã‚’é™¤ã„ãŸæ–‡å­—æ•°`;
            resultsMap.excludedCharLabel.textContent = `ã€Œ${excludedChars}ã€ã®åˆè¨ˆæ–‡å­—æ•°`;
        } else {
            // é™¤å¤–æ–‡å­—ãŒã€Œãªã—ã€ã®å ´åˆã€ãƒ©ãƒ™ãƒ«ã‚’ã‚·ãƒ³ãƒ—ãƒ«ã«æˆ»ã™
            resultsMap.excludedLabel.textContent = `æŒ‡å®šæ–‡å­—ã‚’é™¤ã„ãŸæ–‡å­—æ•°`;
            resultsMap.excludedCharLabel.textContent = `é™¤å¤–æ–‡å­—ã®åˆè¨ˆæ–‡å­—æ•°`;
        }
        
        // 3. --- è©³ç´°ã‚«ã‚¦ãƒ³ãƒˆ ---
        const countLines = inputText.length === 0 ? 0 : inputText.split(/\r?\n/).length;
        const countBytes = getByteLength(inputText);
        const countHiragana = (inputText.match(/[ã-ã‚“]/g) || []).length;
        const countKatakana = (inputText.match(/[ã‚¡-ãƒ¶ãƒ¼]/g) || []).length;
        const countKanji = (inputText.match(/[\u4E00-\u9FAF]/g) || []).length;
        const countUppercase = (inputText.match(/[A-Z]/g) || []).length;
        const countLowercase = (inputText.match(/[a-z]/g) || []).length;
        const countNumber = (inputText.match(/[0-9]/g) || []).length;
        
        // 4. --- çµæœã®è¡¨ç¤ºã‚’æ›´æ–° ---
        resultsMap.totalCount.textContent = countTotal;
        resultsMap.noSpaceCount.textContent = countNoSpace;
        resultsMap.noNewlineCount.textContent = countNoNewline;
        resultsMap.noWhitespaceCount.textContent = countNoWhitespace;
        resultsMap.excludedCount.textContent = countExcluded;
        resultsMap.excludedCharCount.textContent = countExcludedCharsInText;
        resultsMap.lineCount.textContent = countLines;
        resultsMap.byteCount.textContent = countBytes;
        resultsMap.hiraganaCount.textContent = countHiragana;
        resultsMap.katakanaCount.textContent = countKatakana;
        resultsMap.kanjiCount.textContent = countKanji;
        resultsMap.uppercaseCount.textContent = countUppercase;
        resultsMap.lowercaseCount.textContent = countLowercase;
        resultsMap.numberCount.textContent = countNumber;
    }

    // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼ã®è¨­å®š
    textInput.addEventListener('input', updateCounts);
    excludeCharsInput.addEventListener('input', updateCounts);

    // ãƒšãƒ¼ã‚¸ãƒ­ãƒ¼ãƒ‰æ™‚ã«ã‚‚ä¸€åº¦ã‚«ã‚¦ãƒ³ãƒˆã‚’å®Ÿè¡Œ
    updateCounts();
</script>

</body>
</html>
